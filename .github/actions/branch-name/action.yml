name: "Branch Name"
description: "Get branch data. Example: ref/heads/main-123-456-789 => main-123-456-789. Also return safe-strings versions."

outputs:
  branch_name:
    description: "Branch name"
    value: ${{ steps.safe.outputs.branch_name }}
  full_length:
    description: 'Alphanumeric, lowercase, but full length version of the branch.'
    value: ${{ steps.safe.outputs.full_length }}
  safe:
    description: 'Alphanumeric and lowercase version of the branch, trimmed to 12 characters.'
    value: ${{ steps.safe.outputs.safe }}
  source_commitish:
    description: "Commit hashes / branches can be used for comparisions later"
    value: ${{ steps.safe.outputs.source_commitish }}
  destination_commitish:
    description: "Commit hashes / branches can be used for comparisions later"
    value: ${{ steps.safe.outputs.destination_commitish }}

runs:
  using: "composite"
  steps:
    - name: "Setup python"
      uses: actions/setup-python@v5
      with:
        python-version: '3.10'
        cache: 'pip'
    - name: "Setup pip"
      shell: bash
      run: |
        pip install -q -r ${{github.action_path}}/./requirements.txt
    - name: Generate branch info
      id: safe
      shell: bash
      env:
        RUN_AS_TEST: ${{inputs.test}}
      run: |
        src="${{github.action_path}}"
        python ${src}/./branch-name.py \
          --event_name="${GITHUB_EVENT_NAME}" \
          --event_data_file="${GITHUB_EVENT_PATH}"
